<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.58.3" />
    <meta name="description" content="MLOps: Operationalizing Machine Learning">
<meta name="author" content="Theja Tulabandhula">

    <link rel="shortcut icon" href="/MLOps/images/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" sizes="180x180" href="/MLOps/images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/MLOps/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/MLOps/images/favicon-16x16.png">
<link rel="manifest" href="/MLOps/images/site.webmanifest">
    <title>Testing Models :: MLOps: Operationalizing Machine Learning</title>

    
    <link href="/MLOps/css/nucleus.css" rel="stylesheet">
    <link href="/MLOps/css/fontawesome-all.min.css" rel="stylesheet">
    <link href="/MLOps/css/hybrid.css" rel="stylesheet">
    <link href="/MLOps/css/featherlight.min.css" rel="stylesheet">
    <link href="/MLOps/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="/MLOps/css/auto-complete.css" rel="stylesheet">
    <link href="/MLOps/css/atom-one-dark-reasonable.css" rel="stylesheet">
    <link href="/MLOps/css/theme.css" rel="stylesheet">
    <link href="/MLOps/css/hugo-theme.css" rel="stylesheet">
    
      <link href="/MLOps/css/theme-blue.css" rel="stylesheet">
    

    <script src="/MLOps/js/jquery-3.3.1.min.js"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/MLOps/lecture8/modeltesting/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a href="/MLOps/"> <img src="/MLOps/images/logo.png" alt="MLOps"></a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/MLOps/js/lunr.min.js"></script>
<script type="text/javascript" src="/MLOps/js/auto-complete.js"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/chicagodatascience.github.io\/MLOps\/";
    
</script>
<script type="text/javascript" src="/MLOps/js/search.js"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/MLOps/logistics/" title="Course Logistics" class="dd-item 
        
        
        
        ">
      <a href="/MLOps/logistics/">
          <b> </b>Course Logistics
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/logistics/online_technology_requirements/" title="Online Learning Details" class="dd-item ">
        <a href="/MLOps/logistics/online_technology_requirements/">
        Online Learning Details
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/logistics/schedule/" title="Schedule" class="dd-item ">
        <a href="/MLOps/logistics/schedule/">
        <b> </b>Schedule
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/logistics/project_instructions/" title="Project" class="dd-item ">
        <a href="/MLOps/logistics/project_instructions/">
        <b> </b>Project
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/MLOps/lecture1/" title="Lecture 1" class="dd-item 
        
        
        
        ">
      <a href="/MLOps/lecture1/">
          <b> </b>Lecture 1
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/intro/" title="Basics" class="dd-item ">
        <a href="/MLOps/lecture1/intro/">
        <b> 1. </b>Basics
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/ssh_and_firewall/" title="SSH and Firewall" class="dd-item ">
        <a href="/MLOps/lecture1/ssh_and_firewall/">
        <b> 2. </b>SSH and Firewall
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/conda/" title="Setting up Python" class="dd-item ">
        <a href="/MLOps/lecture1/conda/">
        <b> 3. </b>Setting up Python
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/jupyter/" title="Remote Jupyter Server" class="dd-item ">
        <a href="/MLOps/lecture1/jupyter/">
        <b> 4. </b>Remote Jupyter Server
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/MLOps/lecture1/recommendation_model/" title="Recommendation Models" class="dd-item 
        
        
        
        ">
      <a href="/MLOps/lecture1/recommendation_model/">
          <b>5. </b>Recommendation Models
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/recommendation_model/surprise_training/" title="Recommendation (SVD) Training" class="dd-item ">
        <a href="/MLOps/lecture1/recommendation_model/surprise_training/">
        <b> </b>Recommendation (SVD) Training
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/recommendation_model/surprise_inference/" title="Recommendation (SVD) Inference" class="dd-item ">
        <a href="/MLOps/lecture1/recommendation_model/surprise_inference/">
        <b> </b>Recommendation (SVD) Inference
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/recommendation_model/pytorch_training/" title="Recommendation (Pytorch) Training" class="dd-item ">
        <a href="/MLOps/lecture1/recommendation_model/pytorch_training/">
        <b> </b>Recommendation (Pytorch) Training
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/recommendation_model/pytorch_inference/" title="Recommendation (Pytorch) Inference" class="dd-item ">
        <a href="/MLOps/lecture1/recommendation_model/pytorch_inference/">
        <b> </b>Recommendation (Pytorch) Inference
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/deploy_webserver/" title="Serving ML Models Using Web Servers" class="dd-item ">
        <a href="/MLOps/lecture1/deploy_webserver/">
        <b> 6. </b>Serving ML Models Using Web Servers
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/flask/" title="Flask App" class="dd-item ">
        <a href="/MLOps/lecture1/flask/">
        <b> 7. </b>Flask App
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture1/exercises/" title="Exercises" class="dd-item ">
        <a href="/MLOps/lecture1/exercises/">
        <b> </b>Exercises
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/MLOps/lecture2/" title="Lecture 2" class="dd-item 
        
        
        
        ">
      <a href="/MLOps/lecture2/">
          <b> </b>Lecture 2
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture2/serverless/" title="Serverless Deployments" class="dd-item ">
        <a href="/MLOps/lecture2/serverless/">
        <b>1. </b>Serverless Deployments
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture2/cloud_functions/" title="Cloud Functions" class="dd-item ">
        <a href="/MLOps/lecture2/cloud_functions/">
        <b>2. </b>Cloud Functions
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture2/cloud_functions_model/" title="GCP Serverless Model Serving" class="dd-item ">
        <a href="/MLOps/lecture2/cloud_functions_model/">
        <b>3. </b>GCP Serverless Model Serving
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture2/lambda_functions/" title="Lambda Functions" class="dd-item ">
        <a href="/MLOps/lecture2/lambda_functions/">
        <b>4. </b>Lambda Functions
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture2/lambda_functions_model/" title="AWS Serverless Model Serving" class="dd-item ">
        <a href="/MLOps/lecture2/lambda_functions_model/">
        <b>5. </b>AWS Serverless Model Serving
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture2/exercises/" title="Exercises" class="dd-item ">
        <a href="/MLOps/lecture2/exercises/">
        <b> </b>Exercises
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/MLOps/lecture3/" title="Lecture 3" class="dd-item 
        
        
        
        ">
      <a href="/MLOps/lecture3/">
          <b> </b>Lecture 3
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture3/intro/" title="Introduction" class="dd-item ">
        <a href="/MLOps/lecture3/intro/">
        <b>1. </b>Introduction
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture3/docker/" title="Docker" class="dd-item ">
        <a href="/MLOps/lecture3/docker/">
        <b>2. </b>Docker
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture3/ecr/" title="Orchestration using ECS and ECR - Part I" class="dd-item ">
        <a href="/MLOps/lecture3/ecr/">
        <b>3. </b>Orchestration using ECS and ECR - Part I
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture3/ecs/" title="Orchestration using ECS and ECR - Part II" class="dd-item ">
        <a href="/MLOps/lecture3/ecs/">
        <b>4. </b>Orchestration using ECS and ECR - Part II
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture3/exercises/" title="Exercises" class="dd-item ">
        <a href="/MLOps/lecture3/exercises/">
        <b> </b>Exercises
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/MLOps/lecture4/" title="Lecture 4" class="dd-item 
        
        
        
        ">
      <a href="/MLOps/lecture4/">
          <b> </b>Lecture 4
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture4/kubernetes/" title="Kubernetes" class="dd-item ">
        <a href="/MLOps/lecture4/kubernetes/">
        <b>1. </b>Kubernetes
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture4/modelkube/" title="Model Serving using Kubernetes" class="dd-item ">
        <a href="/MLOps/lecture4/modelkube/">
        <b>2. </b>Model Serving using Kubernetes
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture4/gke/" title="Orchestration using GKE" class="dd-item ">
        <a href="/MLOps/lecture4/gke/">
        <b>3. </b>Orchestration using GKE
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture4/exercises/" title="Exercises" class="dd-item ">
        <a href="/MLOps/lecture4/exercises/">
        <b> </b>Exercises
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/MLOps/lecture5/" title="Lecture 5" class="dd-item 
        
        
        
        ">
      <a href="/MLOps/lecture5/">
          <b> </b>Lecture 5
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture5/workflow/" title="Data Science Workflows" class="dd-item ">
        <a href="/MLOps/lecture5/workflow/">
        <b>1. </b>Data Science Workflows
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture5/simple_pipeline/" title="Training Workflows" class="dd-item ">
        <a href="/MLOps/lecture5/simple_pipeline/">
        <b>2. </b>Training Workflows
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture5/cron/" title="Cron Jobs" class="dd-item ">
        <a href="/MLOps/lecture5/cron/">
        <b>3. </b>Cron Jobs
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture5/airflow/" title="Apache Airflow" class="dd-item ">
        <a href="/MLOps/lecture5/airflow/">
        <b>4. </b>Apache Airflow
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture5/exercises/" title="Exercises" class="dd-item ">
        <a href="/MLOps/lecture5/exercises/">
        <b> </b>Exercises
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/MLOps/lecture6/" title="Lecture 6" class="dd-item 
        
        
        
        ">
      <a href="/MLOps/lecture6/">
          <b> </b>Lecture 6
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture6/spark/" title="Spark based Pipelines" class="dd-item ">
        <a href="/MLOps/lecture6/spark/">
        <b>1. </b>Spark based Pipelines
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture6/spark_envs/" title="Spark Clusters" class="dd-item ">
        <a href="/MLOps/lecture6/spark_envs/">
        <b>2. </b>Spark Clusters
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture6/databricks/" title="Spark on Databricks" class="dd-item ">
        <a href="/MLOps/lecture6/databricks/">
        <b>3. </b>Spark on Databricks
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture6/pyspark/" title="PySpark" class="dd-item ">
        <a href="/MLOps/lecture6/pyspark/">
        <b>4. </b>PySpark
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture6/mllib/" title="MLlib - ML Library for Spark" class="dd-item ">
        <a href="/MLOps/lecture6/mllib/">
        <b>5. </b>MLlib - ML Library for Spark
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture6/exercises/" title="Exercises" class="dd-item ">
        <a href="/MLOps/lecture6/exercises/">
        <b> </b>Exercises
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture6/mllib/recommendation_system_mllib/" title="" class="dd-item ">
        <a href="/MLOps/lecture6/mllib/recommendation_system_mllib/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture6/mllib/recommendation_system_surpriselib/" title="" class="dd-item ">
        <a href="/MLOps/lecture6/mllib/recommendation_system_surpriselib/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture6/pyspark/basics/" title="" class="dd-item ">
        <a href="/MLOps/lecture6/pyspark/basics/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/MLOps/lecture7/" title="Lecture 7" class="dd-item 
        
        
        
        ">
      <a href="/MLOps/lecture7/">
          <b> </b>Lecture 7
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture7/streaming/" title="Streaming Workflows" class="dd-item ">
        <a href="/MLOps/lecture7/streaming/">
        <b>1. </b>Streaming Workflows
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture7/kafka/" title="Apache Kafka" class="dd-item ">
        <a href="/MLOps/lecture7/kafka/">
        <b>2. </b>Apache Kafka
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture7/spark_streaming/" title="Spark Streaming" class="dd-item ">
        <a href="/MLOps/lecture7/spark_streaming/">
        <b>3. </b>Spark Streaming
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture7/exercises/" title="Exercises" class="dd-item ">
        <a href="/MLOps/lecture7/exercises/">
        <b> </b>Exercises
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture7/kafka/producer_consumer_example/" title="" class="dd-item ">
        <a href="/MLOps/lecture7/kafka/producer_consumer_example/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture7/spark_streaming/streaming101/" title="" class="dd-item ">
        <a href="/MLOps/lecture7/spark_streaming/streaming101/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture7/spark_streaming/streaming_recs/" title="" class="dd-item ">
        <a href="/MLOps/lecture7/spark_streaming/streaming_recs/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/MLOps/lecture8/" title="Lecture 8" class="dd-item 
        parent
        
        
        ">
      <a href="/MLOps/lecture8/">
          <b> </b>Lecture 8
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture8/abtest/" title="A/B Testing" class="dd-item ">
        <a href="/MLOps/lecture8/abtest/">
        <b>1. </b>A/B Testing
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture8/statistical/" title="Statistical Tests" class="dd-item ">
        <a href="/MLOps/lecture8/statistical/">
        <b>2. </b>Statistical Tests
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/MLOps/lecture8/modeltesting/" title="Testing Models" class="dd-item active">
        <a href="/MLOps/lecture8/modeltesting/">
        <b>3. </b>Testing Models
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    <section id="footer">
      



<i class='fab fa-fw fa-github'></i> <a href="https://github.com/chicagodatascience/MLOps/"> GitHub repo</a>
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span class="links">
                 
                 
                   Testing Models 
                 
                  </span>
                </div>
                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
          <div id="chapter">
        
        <div id="body-inner">
          

        





<h3 id="example-online-experiment">Example Online Experiment</h3>

<ul>
<li>There are many solutions, each with its own nuances. To get to a minimum viable testing setup, we will instead do the following.</li>
<li>We will develop a bare-bones setup to test two recommendation models based on the flask deployment from earlier. This will involve using the open source package <code>planout</code> (see <a href="https://facebook.github.io/planout/index.html">here</a>) to do the randomization.</li>

<li><p>Assuming flask, surpriselib, pytorch and others are already installed, we can install <code>planout</code> using the following:</p>

<pre><code class="language-bash">pip install planout
</code></pre></li>

<li><p>Note that its always good to do the above in a project specific conda environment (such as <code>datasci-dev</code> we have been using before).</p></li>

<li><p>The key idea with using <code>planout</code> here is as follows. While deciding to serve the recommendations to the user when they login and reach the homepage or an appropriate screen, we will randomly pick either the pytorch model or the surpriselib model.</p></li>

<li><p>In particular, the user is assigned to a random cohort in the experiment when they login using help from <code>planout</code>.</p></li>

<li><p>This is accomplished by creating an instance of an appropriately defined <code>ModelExperiment</code> class.</p>

<pre><code class="language-python">model_perf_exp = ModelExperiment(userid=session['userid'])
model_type = model_perf_exp.get('model_type')
</code></pre></li>

<li><p>Here the class <code>ModelExperiment</code> is defined in a straightforward manner:</p>

<pre><code class="language-python">class ModelExperiment(SimpleExperiment):
		def setup(self):
				self.set_log_file('model_abtest.log')
		def assign(self, params, userid):
				params.use_pytorch = BernoulliTrial(p=0.5, unit=userid)
				if params.use_pytorch:
						params.model_type = 'pytorch'
				else:
						params.model_type = 'surprise'
</code></pre></li>

<li><p>The setup function defines where the log for the experiment is stored (this can be changed to a different storage location).</p></li>

<li><p>The assign function uses the user&rsquo;s ID to bucket them into one of the control or treatment cohorts. In our example, lets assume that the surpriselib based recommendation model is the control.</p></li>

<li><p>The complete flask script is as follows.</p>

<ul>
<li><p><a href="model_testing.py">Download</a></p>

<pre><code class="language-python">from surprise import Dataset
from surprise.dump import load as surprise_model_load
import numpy as np
import torch
from torch import nn
import pandas as pd
import random
from uuid import uuid4
from flask import (
	Flask,
	session,
	request,
	redirect,
	url_for,
	render_template_string
)
from planout.experiment import SimpleExperiment
from planout.ops.random import *


class ModelExperiment(SimpleExperiment):
		def setup(self):
				self.set_log_file('model_abtest.log')
		def assign(self, params, userid):
				params.use_pytorch = BernoulliTrial(p=0.5, unit=userid)
				if params.use_pytorch:
						params.model_type = 'pytorch'
				else:
						params.model_type = 'surprise'

class MF(nn.Module):
		itr = 0
		
		def __init__(self, n_user, n_item, k=18, c_vector=1.0, c_bias=1.0):
				super(MF, self).__init__()
				self.k = k
				self.n_user = n_user
				self.n_item = n_item
				self.c_bias = c_bias
				self.c_vector = c_vector
				
				self.user = nn.Embedding(n_user, k)
				self.item = nn.Embedding(n_item, k)
				
				# We've added new terms here:
				self.bias_user = nn.Embedding(n_user, 1)
				self.bias_item = nn.Embedding(n_item, 1)
				self.bias = nn.Parameter(torch.ones(1))
		
		def __call__(self, train_x):
				user_id = train_x[:, 0]
				item_id = train_x[:, 1]
				vector_user = self.user(user_id)
				vector_item = self.item(item_id)
				
				# Pull out biases
				bias_user = self.bias_user(user_id).squeeze()
				bias_item = self.bias_item(item_id).squeeze()
				biases = (self.bias + bias_user + bias_item)
				
				ui_interaction = torch.sum(vector_user * vector_item, dim=1)
				
				# Add bias prediction to the interaction prediction
				prediction = ui_interaction + biases
				return prediction
		
		def loss(self, prediction, target):
				loss_mse = F.mse_loss(prediction, target.squeeze())
				
				# Add new regularization to the biases
				prior_bias_user =  l2_regularize(self.bias_user.weight) * self.c_bias
				prior_bias_item = l2_regularize(self.bias_item.weight) * self.c_bias
				
				prior_user =  l2_regularize(self.user.weight) * self.c_vector
				prior_item = l2_regularize(self.item.weight) * self.c_vector
				total = loss_mse + prior_user + prior_item + prior_bias_user + prior_bias_item
				return total

def get_top_n_pytorch(model,trainset,urid_input,n=10):
		
		testset = trainset.build_anti_testset()
		preds = []
		for urid, irid, _ in testset:
				if urid==urid_input:
						preds.append((irid,float(model(torch.tensor([[int(trainset.to_inner_uid(urid)),
																													int(trainset.to_inner_iid(irid))]]
																											 ))
																		))
												)
		# Then sort the predictions and retrieve the n highest ones.
		preds.sort(key=lambda x: x[1], reverse=True)
		return preds[:n]


def get_top_n_surprise(model,trainset,urid_input,n=10):
		
		testset = trainset.build_anti_testset()
		preds = []
		for urid, irid, _ in testset:
				if urid==urid_input:
						preds.append((irid,float(model.predict(urid, irid).est)))
		# Then sort the predictions and retrieve the n highest ones.
		preds.sort(key=lambda x: x[1], reverse=True)
		return preds[:n]


#Data
df = pd.read_csv('./movies.dat',sep=&quot;::&quot;,header=None,engine='python')
df.columns = ['iid','name','genre']
df.set_index('iid',inplace=True)
data = Dataset.load_builtin('ml-100k')
trainset = data.build_full_trainset()

#Parameters for the pytorch model
lr = 1e-2
k = 10 #latent dimension
c_bias = 1e-6
c_vector = 1e-6

model_pytorch = MF(trainset.n_users, trainset.n_items, k=k, c_bias=c_bias, c_vector=c_vector)
model_pytorch.load_state_dict(torch.load('./pytorch_model'))
model_pytorch.eval()
_, model_surprise = surprise_model_load('./surprise_model')





app = Flask(__name__)

app.config.update(dict(
	DEBUG=True,
	SECRET_KEY='MODEL_TESTING_BY_THEJA_TULABANDHULA',
))


@app.route('/',methods=[&quot;GET&quot;])
def main():
		# if no userid is defined make one up
		if 'userid' not in session:
				session['userid'] = str(random.choice(trainset.all_users()))

		model_perf_exp = ModelExperiment(userid=session['userid'])
		model_type = model_perf_exp.get('model_type')
		resp = {}
		resp[&quot;success&quot;] = False

		print(model_type,resp,session['userid'])

		try:
				if model_type=='pytorch':
						user_ratings = get_top_n_pytorch(model_pytorch,trainset,session['userid'],n=10) 
				elif model_type=='surprise':
						user_ratings = get_top_n_surprise(model_surprise,trainset,session['userid'],n=10) 

				print(user_ratings)
				resp[&quot;response&quot;] = [df.loc[int(iid),'name'] for (iid, _) in user_ratings]
				resp[&quot;success&quot;] = True

				return render_template_string(&quot;&quot;&quot;
				&lt;html&gt;
					&lt;head&gt;
						&lt;title&gt;Recommendation Service&lt;/title&gt;
					&lt;/head&gt;
					&lt;body&gt;
						&lt;h3&gt;
							Recommendations for userid {{ userid }} based on {{ model_type }} are shown below: &lt;br&gt;
						&lt;/h3&gt;

						&lt;p&gt;

						{% for movie_item in resp['response'] %}
						      &lt;h5&gt; {{movie_item}}&lt;/h5&gt;
						{% endfor %}

						&lt;/p&gt;

						&lt;p&gt;
							What will be your rating of this list (rate between 1-10 where 10 is the highest quality)?
						&lt;/p&gt;
						&lt;form action=&quot;/rate&quot; method=&quot;GET&quot;&gt;
							$&lt;input type=&quot;text&quot; length=&quot;10&quot; name=&quot;rate&quot;&gt;&lt;/input&gt;
							&lt;input type=&quot;submit&quot;&gt;&lt;/input&gt;
						&lt;/form&gt;
					&lt;br&gt;
					&lt;p&gt;&lt;a href=&quot;/&quot;&gt;Reload without resetting my user ID. I'll get the same recommendations when I come back.&lt;/a&gt;&lt;/p&gt;
					&lt;p&gt;&lt;a href=&quot;/reset&quot;&gt;Reset my user ID so I am a different user and will get re-randomized into a new treatment.&lt;/a&gt;&lt;/p&gt;
					&lt;/body&gt;
				&lt;/html&gt;
			&quot;&quot;&quot;, userid=session['userid'], model_type=model_type, resp=resp)
		except:
			return render_template_string(&quot;&quot;&quot;
			&lt;html&gt;
				&lt;head&gt;
					&lt;title&gt;Recommendation Service&lt;/title&gt;
				&lt;/head&gt;
				&lt;body&gt;
					&lt;h3&gt;
						Recommendations for userid {{ userid }} based on {{ model_type }} are shown below. &lt;br&gt;
					&lt;/h3&gt;
					&lt;p&gt;
					{{resp}}
					&lt;/p&gt;

					&lt;p&gt;
						What will be your rating of this list (rate between 1-10 where 10 is the highest quality)?
					&lt;/p&gt;
					&lt;form action=&quot;/rate&quot; method=&quot;GET&quot;&gt;
						&lt;input type=&quot;text&quot; length=&quot;10&quot; name=&quot;rate&quot;&gt;&lt;/input&gt;
						&lt;input type=&quot;submit&quot;&gt;&lt;/input&gt;
					&lt;/form&gt;
				&lt;br&gt;
				&lt;p&gt;&lt;a href=&quot;/&quot;&gt;Reload without resetting my user ID. I'll get the same recommendations when I come back.&lt;/a&gt;&lt;/p&gt;
				&lt;p&gt;&lt;a href=&quot;/reset&quot;&gt;Reset my user ID so I am a different user and will get re-randomized into a new treatment.&lt;/a&gt;&lt;/p&gt;
				&lt;/body&gt;
			&lt;/html&gt;
			&quot;&quot;&quot;, userid=session['userid'], model_type=model_type, resp=resp)

@app.route('/reset')
def reset():
		session.clear()
		return redirect(url_for('main'))

@app.route('/rate')
def rate():
		rate_string = request.args.get('rate')
		try:
				rate_val = int(rate_string)
				assert rate_val &gt; 0 and rate_val &lt; 11

				model_perf_exp = ModelExperiment(userid=session['userid'])
				model_perf_exp.log_event('rate', {'rate_val': rate_val})

				return render_template_string(&quot;&quot;&quot;
					&lt;html&gt;
						&lt;head&gt;
							&lt;title&gt;Thank you for the feedback!&lt;/title&gt;
						&lt;/head&gt;
						&lt;body&gt;
							&lt;p&gt;You rating is {{ rate_val }}. Hit the back button or click below to go back to recommendations!&lt;/p&gt;
							&lt;p&gt;&lt;a href=&quot;/&quot;&gt;Back&lt;/a&gt;&lt;/p&gt;
						&lt;/body&gt;
					&lt;/html&gt;
					&quot;&quot;&quot;, rate_val=rate_val)
		except:
				return render_template_string(&quot;&quot;&quot;
					&lt;html&gt;
						&lt;head&gt;
							&lt;title&gt;Bad rating!&lt;/title&gt;
						&lt;/head&gt;
						&lt;body&gt;
							&lt;p&gt;You rating could not be parsed. That's probably not a number between 1 and 10, so we won't be accepting your rating.&lt;/p&gt;
							&lt;p&gt;&lt;a href=&quot;/&quot;&gt;Back&lt;/a&gt;&lt;/p&gt;
						&lt;/body&gt;
					&lt;/html&gt;
					&quot;&quot;&quot;)


# start the flask app, allow remote connections
app.run(host='0.0.0.0')
</code></pre></li>
</ul></li>
</ul>


<footer class="footline">
	
</footer>

        
            </div> 
        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/MLOps/lecture8/statistical/" title="Statistical Tests"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/MLOps/lecture8/abtest/" title="A/B Testing" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/MLOps/js/clipboard.min.js"></script>
    <script src="/MLOps/js/perfect-scrollbar.min.js"></script>
    <script src="/MLOps/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="/MLOps/js/jquery.sticky.js"></script>
    <script src="/MLOps/js/featherlight.min.js"></script>
    <script src="/MLOps/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/MLOps/js/modernizr.custom-3.6.0.js"></script>
    <script src="/MLOps/js/learn.js"></script>
    <script src="/MLOps/js/hugo-learn.js"></script>

    <link href="/MLOps/mermaid/mermaid.css" rel="stylesheet" />
    <script src="/MLOps/mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156050402-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-156050402-2');
</script>




<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">

  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>

  </body>
</html>

